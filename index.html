<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MAPA DA COLE√á√ÉO PERFEITA</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e1e1e 0%, #2d2d2d 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
        }

        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            background: linear-gradient(90deg, #d4af37, #f4e5b1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .subtitle {
            color: #999;
            font-size: 1.1em;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 40px;
        }

        .card {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(212, 175, 55, 0.3);
            border-radius: 15px;
            padding: 25px;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .card:hover {
            transform: translateY(-5px);
            border-color: #d4af37;
            box-shadow: 0 10px 30px rgba(212, 175, 55, 0.3);
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: linear-gradient(90deg, #d4af37, #f4e5b1);
        }

        .card-title {
            color: #d4af37;
            font-size: 1.4em;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .card-description {
            color: #ccc;
            font-size: 0.95em;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .card-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 15px;
        }

        .tag {
            background: rgba(212, 175, 55, 0.2);
            color: #d4af37;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            border: 1px solid rgba(212, 175, 55, 0.3);
        }

        .examples {
            background: rgba(212, 175, 55, 0.1);
            padding: 12px;
            border-radius: 8px;
            margin-top: 15px;
        }

        .examples-title {
            color: #d4af37;
            font-size: 0.9em;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .examples-list {
            color: #aaa;
            font-size: 0.85em;
            line-height: 1.5;
        }

        .section-title {
            color: white;
            font-size: 1.8em;
            margin: 40px 0 20px 0;
            text-align: center;
        }

        .levels {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            justify-content: center;
            margin-top: 30px;
        }

        .level-card {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(212, 175, 55, 0.3);
            border-radius: 15px;
            padding: 30px;
            flex: 1;
            min-width: 300px;
            max-width: 400px;
        }

        .level-title {
            color: #d4af37;
            font-size: 1.5em;
            margin-bottom: 20px;
            text-align: center;
        }

        .level-item {
            background: rgba(212, 175, 55, 0.1);
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 10px;
            color: #ccc;
            font-size: 0.95em;
        }

        .level-item strong {
            color: #d4af37;
            display: block;
            margin-bottom: 5px;
        }

        .interactive-note {
            background: rgba(100, 150, 255, 0.1);
            border: 2px solid rgba(100, 150, 255, 0.3);
            border-radius: 10px;
            padding: 20px;
            margin-top: 40px;
            text-align: center;
            color: #9bc4ff;
        }

        .checkbox-container {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 10px;
            padding: 15px;
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.15), rgba(212, 175, 55, 0.05));
            border: 2px solid rgba(212, 175, 55, 0.4);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .checkbox-container:hover {
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.25), rgba(212, 175, 55, 0.1));
            border-color: #d4af37;
            transform: translateX(5px);
        }

        .checkbox-container input {
            width: 22px;
            height: 22px;
            cursor: pointer;
            accent-color: #d4af37;
        }

        .checkbox-container label {
            cursor: pointer;
            flex: 1;
            color: #f4e5b1;
            font-weight: 600;
            font-size: 1.05em;
        }

        @media (max-width: 1024px) {
            .grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.8em;
            }
            
            .grid {
                grid-template-columns: 1fr;
            }
        }

        .balance-section {
            display: flex;
            justify-content: center;
            margin-top: 30px;
        }

        .balance-card {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(212, 175, 55, 0.3);
            border-radius: 15px;
            padding: 40px;
            max-width: 800px;
            width: 100%;
        }

        .balance-title {
            color: #d4af37;
            font-size: 1.8em;
            margin-bottom: 15px;
            text-align: center;
        }

        .balance-description {
            color: #ccc;
            text-align: center;
            margin-bottom: 30px;
            line-height: 1.6;
        }

        .family-counter {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .counter-item {
            background: rgba(212, 175, 55, 0.1);
            padding: 15px;
            border-radius: 10px;
            border: 1px solid rgba(212, 175, 55, 0.2);
        }

        .counter-item label {
            color: #d4af37;
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .counter-item input {
            width: 100%;
            padding: 10px;
            font-size: 1.2em;
            text-align: center;
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid rgba(212, 175, 55, 0.3);
            border-radius: 5px;
            color: white;
        }

        .counter-item input:focus {
            outline: none;
            border-color: #d4af37;
        }

        .analyze-btn {
            width: 100%;
            padding: 15px;
            font-size: 1.2em;
            font-weight: 600;
            background: linear-gradient(90deg, #d4af37, #f4e5b1);
            color: #1e1e1e;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .analyze-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(212, 175, 55, 0.4);
        }

        .result-box {
            margin-top: 30px;
            background: rgba(212, 175, 55, 0.1);
            border: 2px solid #d4af37;
            border-radius: 10px;
            padding: 25px;
        }

        .result-title {
            color: #d4af37;
            font-size: 1.3em;
            font-weight: 600;
            margin-bottom: 20px;
            text-align: center;
        }

        .result-content {
            color: white;
            font-size: 1.1em;
            margin-bottom: 15px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
        }

        .result-advice {
            color: #ccc;
            line-height: 1.8;
            margin-bottom: 15px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
        }

        .result-next {
            color: #9bc4ff;
            background: rgba(100, 150, 255, 0.1);
            border: 2px solid rgba(100, 150, 255, 0.3);
            padding: 15px;
            border-radius: 8px;
            line-height: 1.8;
        }

        .result-next strong {
            color: #fff;
        }

        .context-section {
            background: rgba(100, 150, 255, 0.1);
            border: 2px solid rgba(100, 150, 255, 0.3);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
        }

        .context-title {
            color: #9bc4ff;
            font-size: 1.2em;
            font-weight: 600;
            margin-bottom: 15px;
            text-align: center;
        }

        .context-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .context-item label {
            color: #9bc4ff;
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .context-item input[type="text"] {
            width: 100%;
            padding: 10px;
            font-size: 1em;
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid rgba(100, 150, 255, 0.3);
            border-radius: 5px;
            color: white;
        }

        .context-item input[type="text"]:focus {
            outline: none;
            border-color: #9bc4ff;
        }

        .context-item input[type="number"] {
            width: 100%;
            padding: 10px;
            font-size: 1em;
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid rgba(100, 150, 255, 0.3);
            border-radius: 5px;
            color: white;
        }

        .context-item input[type="number"]:focus {
            outline: none;
            border-color: #9bc4ff;
        }

        .checkbox-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .checkbox-label {
            display: flex;
            align-items: center;
            gap: 10px;
            color: #ccc;
            cursor: pointer;
            padding: 8px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 5px;
            transition: all 0.2s ease;
        }

        .checkbox-label:hover {
            background: rgba(100, 150, 255, 0.1);
        }

        .checkbox-label input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        /* ========================================
           CSS RESPONSIVO PARA BOT√ÉO ADICIONAR
           ======================================== */

        /* Container do input + bot√£o ADICIONAR */
        .perfume-add-container {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        /* MOBILE: Bot√£o embaixo do input */
        @media (max-width: 768px) {
            .perfume-add-container {
                flex-direction: column;
                gap: 12px;
            }
            
            .perfume-add-container button {
                width: 100%;
                padding: 14px 25px !important;
                font-size: 1.05em !important;
            }
            
            .perfume-add-container input {
                width: 100% !important;
                padding: 14px 15px !important;
            }
        }

        /* TABLET: Mant√©m lado a lado mas com melhor espa√ßamento */
        @media (min-width: 769px) and (max-width: 1024px) {
            .perfume-add-container {
                gap: 12px;
            }
        }

    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>MAPA DA COLE√á√ÉO PERFEITA</h1>
            <p class="subtitle">Monte sua cole√ß√£o sem redund√¢ncias e com fun√ß√£o real</p>
        </header>

        <h2 class="section-title">AS 6 FUN√á√ïES ESSENCIAIS</h2>
        
        <div class="grid">
            <div class="card">
                <div class="card-title">üåû CALOR</div>
                <div class="card-description">
                    Perfume leve, fresco e que n√£o sufoca. Alta temperatura exige baixa densidade. Evite doces pesados e √¢mbares densos.
                </div>
                <div class="card-tags">
                    <span class="tag">C√≠trico</span>
                    <span class="tag">Aqu√°tico</span>
                    <span class="tag">Verde</span>
                </div>
                <div class="examples">
                    <div class="examples-title">Constru√ß√µes ideais:</div>
                    <div class="examples-list">
                        ‚Ä¢ C√≠trico + aqu√°tico<br>
                        ‚Ä¢ Verde fresco<br>
                        ‚Ä¢ Arom√°tico leve
                    </div>
                </div>
                <div class="checkbox-container">
                    <input type="checkbox" id="calor">
                    <label for="calor">Tenho um perfume para calor</label>
                </div>
            </div>

            <div class="card">
                <div class="card-title">‚ùÑÔ∏è FRIO</div>
                <div class="card-description">
                    Perfume denso, quente e envolvente. Baixa temperatura pede alta proje√ß√£o. Aqui entram os √¢mbares, especiarias e madeiras.
                </div>
                <div class="card-tags">
                    <span class="tag">√Çmbar</span>
                    <span class="tag">Madeira</span>
                    <span class="tag">Especiaria</span>
                </div>
                <div class="examples">
                    <div class="examples-title">Constru√ß√µes ideais:</div>
                    <div class="examples-list">
                        ‚Ä¢ √Çmbar + baunilha<br>
                        ‚Ä¢ Madeira seca + especiaria<br>
                        ‚Ä¢ Oriental denso
                    </div>
                </div>
                <div class="checkbox-container">
                    <input type="checkbox" id="frio">
                    <label for="frio">Tenho um perfume para frio</label>
                </div>
            </div>

            <div class="card">
                <div class="card-title">üíº TRABALHO</div>
                <div class="card-description">
                    Perfume discreto, profissional e sem polariza√ß√£o. M√©dio alcance, baixa do√ßura. Deve passar despercebido at√© ser notado de perto.
                </div>
                <div class="card-tags">
                    <span class="tag">Arom√°tico</span>
                    <span class="tag">Amadeirado seco</span>
                    <span class="tag">Fresco discreto</span>
                </div>
                <div class="examples">
                    <div class="examples-title">Constru√ß√µes ideais:</div>
                    <div class="examples-list">
                        ‚Ä¢ Arom√°tico limpo<br>
                        ‚Ä¢ Amadeirado elegante<br>
                        ‚Ä¢ Fresco-seco balanceado
                    </div>
                </div>
                <div class="checkbox-container">
                    <input type="checkbox" id="trabalho">
                    <label for="trabalho">Tenho um perfume para trabalho</label>
                </div>
            </div>

            <div class="card">
                <div class="card-title">üåô NOITE</div>
                <div class="card-description">
                    Perfume marcante, de presen√ßa forte. Alta proje√ß√£o, notas intensas. Aqui voc√™ pode ousar: doces densos, especiarias, couro.
                </div>
                <div class="card-tags">
                    <span class="tag">Doce denso</span>
                    <span class="tag">Couro</span>
                    <span class="tag">Oriental intenso</span>
                </div>
                <div class="examples">
                    <div class="examples-title">Constru√ß√µes ideais:</div>
                    <div class="examples-list">
                        ‚Ä¢ Doce + especiaria<br>
                        ‚Ä¢ Couro + fuma√ßa<br>
                        ‚Ä¢ √Çmbar + oud
                    </div>
                </div>
                <div class="checkbox-container">
                    <input type="checkbox" id="noite">
                    <label for="noite">Tenho um perfume para noite</label>
                </div>
            </div>

            <div class="card">
                <div class="card-title">‚úçÔ∏è ASSINATURA</div>
                <div class="card-description">
                    Seu perfume identidade. O que te representa independente de contexto. Deve ser confort√°vel, vers√°til e voc√™ deve amar us√°-lo.
                </div>
                <div class="card-tags">
                    <span class="tag">Pessoal</span>
                    <span class="tag">Vers√°til</span>
                    <span class="tag">Confort√°vel</span>
                </div>
                <div class="examples">
                    <div class="examples-title">Caracter√≠sticas:</div>
                    <div class="examples-list">
                        ‚Ä¢ Funciona em v√°rias situa√ß√µes<br>
                        ‚Ä¢ Voc√™ nunca cansa dele<br>
                        ‚Ä¢ As pessoas te associam a ele
                    </div>
                </div>
                <div class="checkbox-container">
                    <input type="checkbox" id="assinatura">
                    <label for="assinatura">Tenho meu perfume assinatura</label>
                </div>
            </div>

            <div class="card">
                <div class="card-title">üéä OCASI√ïES ESPECIAIS</div>
                <div class="card-description">
                    Perfume para momentos √∫nicos. Casamentos, festas, eventos importantes, anivers√°rios. Aquele que voc√™ reserva para ocasi√µes memor√°veis.
                </div>
                <div class="card-tags">
                    <span class="tag">Festivo</span>
                    <span class="tag">Marcante</span>
                    <span class="tag">Especial</span>
                </div>
                <div class="examples">
                    <div class="examples-title">Ocasi√µes ideais:</div>
                    <div class="examples-list">
                        ‚Ä¢ Casamentos e formaturas<br>
                        ‚Ä¢ Festas e celebra√ß√µes<br>
                        ‚Ä¢ Jantares especiais e eventos
                    </div>
                </div>
                <div class="checkbox-container">
                    <input type="checkbox" id="ocasioes">
                    <label for="ocasioes">Tenho perfume para ocasi√µes especiais</label>
                </div>
            </div>
        </div>

        <h2 class="section-title">üéØ DIAGN√ìSTICO AVAN√áADO: SUA COLE√á√ÉO EST√Å EQUILIBRADA?</h2>
        
        <div class="balance-section">
            <div class="balance-card">
                <div class="balance-title">Identifique sua fam√≠lia dominante</div>
                <div class="balance-description">
                    Conte quantos perfumes voc√™ tem de cada fam√≠lia. A fam√≠lia com mais perfumes √© sua dominante.
                </div>

                <div class="context-section">
                    <div class="context-title">üìç Contexto Pessoal</div>
                    <div style="
                        display: grid;
                        grid-template-columns: 1fr 1fr;
                        gap: 25px;
                    ">
                        <!-- COLUNA ESQUERDA: AMBIENTE + OR√áAMENTO -->
                        <div style="display: flex; flex-direction: column; gap: 15px;">
                            <div class="context-item">
                                <label style="margin-bottom: 10px; display: block; color: #9bc4ff; font-weight: 600;">üíº Ambiente de trabalho:</label>
                                <select id="ambiente" style="
                                    width: 100%;
                                    padding: 12px 15px;
                                    font-size: 1em;
                                    background: rgba(0, 0, 0, 0.3);
                                    border: 2px solid rgba(100, 150, 255, 0.3);
                                    border-radius: 8px;
                                    color: white;
                                    cursor: pointer;
                                    transition: all 0.3s ease;
                                " onfocus="this.style.borderColor='#9bc4ff'" onblur="this.style.borderColor='rgba(100, 150, 255, 0.3)'">
                                    <option value="" selected disabled>Selecione seu ambiente</option>
                                    <option value="fechado">Fechado (escrit√≥rio, loja)</option>
                                    <option value="aberto">Aberto (obra, rua, campo)</option>
                                    <option value="ambos">Ambos</option>
                                </select>
                            </div>
                            
                            <div class="context-item">
                                <label for="orcamento" style="margin-bottom: 10px; display: block; color: #9bc4ff; font-weight: 600;">üí∞ Or√ßamento:</label>
                                <select id="orcamento" style="
                                    width: 100%;
                                    padding: 12px 15px;
                                    font-size: 1em;
                                    background: rgba(0, 0, 0, 0.3);
                                    border: 2px solid rgba(100, 150, 255, 0.3);
                                    border-radius: 8px;
                                    color: white;
                                    cursor: pointer;
                                    transition: all 0.3s ease;
                                " onfocus="this.style.borderColor='#9bc4ff'" onblur="this.style.borderColor='rgba(100, 150, 255, 0.3)'">
                                    <option value="" selected disabled>Selecione sua faixa</option>
                                    <option value="ate-350">At√© R$ 350</option>
                                    <option value="350-1500">R$ 350 - R$ 1.500</option>
                                    <option value="1500-2500">R$ 1.500 - R$ 2.500</option>
                                    <option value="sem-limite">Sem limite</option>
                                </select>
                            </div>
                        </div>
                        
                        <!-- COLUNA DIREITA: CLIMA -->
                        <div class="context-item">
                            <label style="margin-bottom: 10px; display: block; color: #9bc4ff; font-weight: 600;">üå°Ô∏è Clima da sua regi√£o:</label>
                            <input type="hidden" id="clima" value="temperado">
                            <div style="display: flex; gap: 10px; margin-top: 10px;">
                                <button type="button" onclick="selecionarClima('quente', this)" class="clima-btn" style="
                                    flex: 1;
                                    padding: 15px 10px;
                                    background: rgba(255, 100, 100, 0.1);
                                    border: 2px solid rgba(255, 100, 100, 0.3);
                                    color: white;
                                    border-radius: 10px;
                                    cursor: pointer;
                                    font-size: 0.95em;
                                    transition: all 0.3s;
                                    text-align: center;
                                ">
                                    <div style="font-size: 1.5em; margin-bottom: 5px;">‚òÄÔ∏è</div>
                                    <div style="font-weight: 600;">Quente</div>
                                    <div style="font-size: 0.75em; color: #888; margin-top: 3px;">Norte, Nordeste</div>
                                </button>
                                
                                <button type="button" onclick="selecionarClima('temperado', this)" class="clima-btn" style="
                                    flex: 1;
                                    padding: 15px 10px;
                                    background: rgba(212, 175, 55, 0.3);
                                    border: 2px solid #d4af37;
                                    color: white;
                                    border-radius: 10px;
                                    cursor: pointer;
                                    font-size: 0.95em;
                                    transition: all 0.3s;
                                    text-align: center;
                                    box-shadow: 0 0 20px rgba(212, 175, 55, 0.5);
                                ">
                                    <div style="font-size: 1.5em; margin-bottom: 5px;">üå§Ô∏è</div>
                                    <div style="font-weight: 600;">Temperado</div>
                                    <div style="font-size: 0.75em; color: #888; margin-top: 3px;">Sudeste</div>
                                </button>
                                
                                <button type="button" onclick="selecionarClima('frio', this)" class="clima-btn" style="
                                    flex: 1;
                                    padding: 15px 10px;
                                    background: rgba(150, 200, 255, 0.1);
                                    border: 2px solid rgba(150, 200, 255, 0.3);
                                    color: white;
                                    border-radius: 10px;
                                    cursor: pointer;
                                    font-size: 0.95em;
                                    transition: all 0.3s;
                                    text-align: center;
                                ">
                                    <div style="font-size: 1.5em; margin-bottom: 5px;">‚ùÑÔ∏è</div>
                                    <div style="font-weight: 600;">Frio</div>
                                    <div style="font-size: 0.75em; color: #888; margin-top: 3px;">Sul</div>
                                </button>
                            </div>
                            
                            <style>
                                .clima-btn:hover {
                                    transform: translateY(-3px) scale(1.05);
                                    box-shadow: 0 8px 25px rgba(212, 175, 55, 0.6);
                                    border-color: #d4af37;
                                }
                                
                                .clima-btn.selected-quente {
                                    background: rgba(255, 100, 100, 0.3) !important;
                                    border-color: #ff6666 !important;
                                    box-shadow: 0 0 20px rgba(255, 100, 100, 0.6) !important;
                                }
                                
                                .clima-btn.selected-temperado {
                                    background: rgba(212, 175, 55, 0.3) !important;
                                    border-color: #d4af37 !important;
                                    box-shadow: 0 0 20px rgba(212, 175, 55, 0.5) !important;
                                }
                                
                                .clima-btn.selected-frio {
                                    background: rgba(100, 150, 255, 0.3) !important;
                                    border-color: #6699ff !important;
                                    box-shadow: 0 0 20px rgba(100, 150, 255, 0.6) !important;
                                }
                            </style>
                        </div>
                    </div>
                    
                    <style>
                        @media (max-width: 768px) {
                            .context-section > div:nth-child(2) {
                                grid-template-columns: 1fr !important;
                            }
                        }
                    </style>
                </div>
                
                
                <!-- Sistema de adicionar perfumes √† cole√ß√£o -->
                <div style="
                    background: rgba(212, 175, 55, 0.08);
                    border: 2px solid rgba(212, 175, 55, 0.3);
                    border-radius: 15px;
                    padding: 25px;
                    margin-bottom: 30px;
                ">
                    <h3 style="
                        color: #d4af37;
                        text-align: center;
                        margin-bottom: 20px;
                        font-size: 1.4em;
                    ">
                        üìù Adicionar Perfumes √† Minha Cole√ß√£o
                    </h3>
                    
                    <div class="perfume-add-container">
                        <input 
                            type="text" 
                            id="perfume-input" 
                            placeholder="Ex: Dior Sauvage EDT"
                            style="
                                flex: 1;
                                padding: 12px 15px;
                                background: rgba(0, 0, 0, 0.4);
                                border: 2px solid rgba(212, 175, 55, 0.3);
                                border-radius: 10px;
                                color: white;
                                font-size: 1em;
                            "
                        >
                        <button 
                            onclick="adicionarPerfume()" 
                            style="
                                padding: 12px 25px;
                                background: linear-gradient(135deg, #d4af37 0%, #f4e5b1 100%);
                                border: none;
                                border-radius: 10px;
                                color: #000;
                                font-weight: 700;
                                cursor: pointer;
                                font-size: 1em;
                                transition: all 0.3s ease;
                            "
                            onmouseover="this.style.transform='scale(1.05)'"
                            onmouseout="this.style.transform='scale(1)'"
                        >
                            + ADICIONAR
                        </button>
                    </div>
                    
                    <div style="
                        display: flex;
                        justify-content: space-between;
                        align-items: center;
                        padding: 12px;
                        background: rgba(0, 0, 0, 0.3);
                        border-radius: 8px;
                    ">
                        <div style="color: #ccc;">
                            <span style="color: #d4af37; font-weight: 700; font-size: 1.1em;" id="perfume-count">0</span>
                            <span style="margin-left: 5px;">perfumes adicionados</span>
                        </div>
                        <button 
                            onclick="abrirPopupColecao()" 
                            id="btn-ver-colecao"
                            style="
                                padding: 8px 18px;
                                background: rgba(212, 175, 55, 0.15);
                                border: 2px solid rgba(212, 175, 55, 0.4);
                                border-radius: 8px;
                                color: #d4af37;
                                font-weight: 600;
                                cursor: pointer;
                                transition: all 0.3s ease;
                            "
                            onmouseover="this.style.background='rgba(212, 175, 55, 0.25)'; this.style.borderColor='#d4af37'"
                            onmouseout="this.style.background='rgba(212, 175, 55, 0.15)'; this.style.borderColor='rgba(212, 175, 55, 0.4)'"
                        >
                            üëÅÔ∏è VER COLE√á√ÉO
                        </button>
                    </div>
                </div>


                <!-- ========================================
                     SE√á√ÉO: PERGUNTAS AO PERFUMISTA
                     ======================================== -->
                <div class="interactive-note" style="margin-top: 40px; margin-bottom: 40px;">
                    <h3 style="
                        color: #d4af37;
                        font-size: 1.5em;
                        margin-bottom: 15px;
                        text-align: center;
                    ">
                        üí¨ Pergunte ao Perfumista
                    </h3>
                    
                    <p style="
                        color: #ccc;
                        text-align: center;
                        margin-bottom: 20px;
                        line-height: 1.6;
                    ">
                        Precisa saber se um perfume combina com sua cole√ß√£o?<br>
                        Ou quer mais sugest√µes personalizadas? Digite aqui!
                    </p>

                    <div style="
                        display: flex;
                        flex-direction: column;
                        gap: 15px;
                        margin-bottom: 20px;
                    ">
                        <textarea 
                            id="pergunta-input" 
                            placeholder="Ex: O Dior Homme combina com minha cole√ß√£o? | Preciso de um perfume para o trabalho | Tenho R$400, o que comprar?"
                            style="
                                width: 100%;
                                min-height: 80px;
                                padding: 15px;
                                background: rgba(0, 0, 0, 0.4);
                                border: 2px solid rgba(212, 175, 55, 0.3);
                                border-radius: 10px;
                                color: white;
                                font-size: 1em;
                                font-family: inherit;
                                resize: vertical;
                            "
                        ></textarea>
                        
                        <button 
                            onclick="perguntarAoPerfumista()" 
                            style="
                                padding: 14px 30px;
                                background: linear-gradient(135deg, #d4af37 0%, #f4e5b1 100%);
                                border: none;
                                border-radius: 10px;
                                color: #000;
                                font-weight: 700;
                                cursor: pointer;
                                font-size: 1.05em;
                                transition: all 0.3s ease;
                                align-self: center;
                            "
                            onmouseover="this.style.transform='scale(1.05)'"
                            onmouseout="this.style.transform='scale(1)'"
                        >
                            üéØ PERGUNTAR
                        </button>
                    </div>

                    <div id="resposta-pergunta" style="display: none; margin-top: 20px;">
                        <div style="
                            background: rgba(212, 175, 55, 0.1);
                            border: 2px solid rgba(212, 175, 55, 0.3);
                            border-radius: 12px;
                            padding: 20px;
                            margin-bottom: 20px;
                        ">
                            <div style="color: #d4af37; font-weight: 600; font-size: 1.1em; margin-bottom: 10px;">
                                üí° Resposta:
                            </div>
                            <div id="texto-resposta" style="color: #f4e5b1; line-height: 1.6;"></div>
                        </div>

                        <div style="
                            color: #d4af37;
                            font-weight: 600;
                            font-size: 1.2em;
                            margin-bottom: 15px;
                            text-align: center;
                        ">
                            üéÅ 3 Sugest√µes Personalizadas:
                        </div>

                        <div id="sugestoes-lista" style="
                            display: grid;
                            gap: 15px;
                        "></div>
                    </div>
                </div>


                <button class="analyze-btn" onclick="analyzeCollection()">MAPEIE MINHA COLE√á√ÉO</button>

                <div id="result" class="result-box" style="display: none;">
                    <div class="result-title">üìä RESULTADO DA AN√ÅLISE</div>
                    <div id="dominant-family" class="result-content"></div>
                    <div id="balance-advice" class="result-advice"></div>
                    <div id="next-purchase" class="result-next"></div>
                </div>


            </div>
        </div>

        <div class="interactive-note">
            <h3 style="margin-bottom: 15px;">üìã COMO USAR ESTE MAPA</h3>
            <p style="line-height: 1.8;">
                1. Marque as caixas dos perfumes que voc√™ J√Å TEM<br>
                2. Veja quais fun√ß√µes est√£o descobertas<br>
                3. Seu pr√≥ximo perfume deve preencher uma lacuna real<br>
                4. Se todas as fun√ß√µes est√£o cobertas, voc√™ n√£o precisa comprar nada novo
            </p>
        </div>
    </div>

    <script>
        // ===============================================
        // SELECIONAR CLIMA
        // ===============================================
        function selecionarClima(clima, btn) {
            document.querySelectorAll('.clima-btn').forEach(function(b) {
                b.classList.remove('selected-quente');
                b.classList.remove('selected-temperado');
                b.classList.remove('selected-frio');
            });
            
            btn.classList.add('selected-' + clima);
            document.getElementById('clima').value = clima;
            localStorage.setItem('clima', clima);
            console.log('‚úÖ Clima selecionado:', clima);
        }

        // Salvar estado dos checkboxes
        document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
            checkbox.addEventListener('change', function() {
                localStorage.setItem(this.id, this.checked);
            });
            
            const saved = localStorage.getItem(checkbox.id);
            if (saved === 'true') {
                checkbox.checked = true;
            }
        });


        // ===============================================
        // ANALISAR COLE√á√ÉO
        // ===============================================

        // ===============================================
        // ANALISAR COLE√á√ÉO - CHAMADA DIRETA √Ä API
        // ===============================================
        
        async function analyzeCollection() {
            console.log('üöÄ Analisando cole√ß√£o...');
            
            const perfumes = JSON.parse(localStorage.getItem('minhaColecao') || '[]');
            
            if (perfumes.length === 0) {
                alert('‚ö†Ô∏è Adicione pelo menos 1 perfume √† sua cole√ß√£o para analisar!');
                return;
            }
            
            const clima = document.getElementById('clima').value || 'temperado';
            const ambiente = document.getElementById('ambiente').value;
            const orcamento = document.getElementById('orcamento').value;
            
            if (!ambiente) {
                alert('‚ö†Ô∏è Por favor, selecione seu ambiente de trabalho!');
                document.getElementById('ambiente').focus();
                return;
            }
            
            if (!orcamento) {
                alert('‚ö†Ô∏è Por favor, selecione sua faixa de or√ßamento!');
                document.getElementById('orcamento').focus();
                return;
            }
            
            console.log('‚úÖ Valida√ß√µes OK');
            
            mostrarLoading(clima, ambiente, orcamento);
            
            // Montar diagn√≥stico
            const diagnostico = `
COLE√á√ÉO COMPLETA:
${perfumes.map((p, i) => `${i + 1}. ${p}`).join('\n')}

CONTEXTO:
- Clima: ${clima === 'quente' ? 'üå°Ô∏è Quente' : clima === 'frio' ? '‚ùÑÔ∏è Frio' : 'üå§Ô∏è Temperado'}
- Ambiente de trabalho: ${ambiente === 'fechado' ? 'üè¢ Fechado' : ambiente === 'aberto' ? 'üå≥ Aberto' : 'üîÄ Ambos'}
- Faixa de or√ßamento: ${orcamento}

OBJETIVO:
Analise minha cole√ß√£o completa e retorne an√°lise detalhada + recomenda√ß√µes.
            `.trim();
            
            localStorage.setItem('diagnostico_completo', diagnostico);
            localStorage.setItem('contexto_clima', clima);
            localStorage.setItem('contexto_ambiente', ambiente);
            localStorage.setItem('contexto_orcamento', orcamento);
            
            console.log('üìã Diagn√≥stico montado');
            
            // Chamar API direto
            try {
                console.log('üåê Chamando API...');
                
                const response = await fetch('https://operfumista-api.vercel.app/api/perfumista', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        diagnostico: diagnostico
                    })
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}`);
                }
                
                const data = await response.json();
                console.log('‚úÖ Resposta recebida da API');
                
                renderizarResultado(data);
                
            } catch (error) {
                console.error('‚ùå Erro na API:', error);
                mostrarErro('Erro ao conectar com servidor. Verifique sua conex√£o.');
            }
        }
        
        function mostrarLoading(clima, ambiente, orcamento) {
            const resultDiv = document.getElementById('result');
            const dominantDiv = document.getElementById('dominant-family');
            const adviceDiv = document.getElementById('balance-advice');
            const nextDiv = document.getElementById('next-purchase');
            
            dominantDiv.innerHTML = `
                <div style="
                    background: rgba(212, 175, 55, 0.08);
                    border: 2px solid rgba(212, 175, 55, 0.3);
                    border-radius: 12px;
                    padding: 40px;
                    text-align: center;
                ">
                    <div style="font-size: 1.5em; color: #d4af37; margin-bottom: 20px;">
                        ü§ñ Analisando sua cole√ß√£o com IA...
                    </div>
                    <div style="
                        width: 50px;
                        height: 50px;
                        border: 5px solid rgba(212, 175, 55, 0.3);
                        border-top-color: #d4af37;
                        border-radius: 50%;
                        margin: 0 auto 20px;
                        animation: spin 1s linear infinite;
                    "></div>
                    <div style="color: #ccc; font-size: 0.95em;">
                        Identificando fam√≠lias, calculando equil√≠brio e buscando recomenda√ß√µes personalizadas...
                    </div>
                </div>
                <style>
                    @keyframes spin {
                        to { transform: rotate(360deg); }
                    }
                </style>
            `;
            
            adviceDiv.innerHTML = '';
            nextDiv.innerHTML = '';
            
            resultDiv.style.display = 'block';
            resultDiv.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
        function renderizarResultado(resultado) {
            console.log('üé® Renderizando resultado...');
            
            try {
                const data = typeof resultado === 'string' ? JSON.parse(resultado) : resultado;
                
                if (!data.analise_colecao || !data.recomendacoes) {
                    throw new Error('Formato inv√°lido');
                }
                
                const analise = data.analise_colecao;
                const recomendacoes = data.recomendacoes;
                
                const clima = localStorage.getItem('contexto_clima') || 'temperado';
                const ambiente = localStorage.getItem('contexto_ambiente') || '';
                const orcamento = localStorage.getItem('contexto_orcamento') || '';
                
                const climaLabel = clima === 'quente' ? 'üå°Ô∏è Quente' : clima === 'frio' ? '‚ùÑÔ∏è Frio' : 'üå§Ô∏è Temperado';
                const ambienteLabel = ambiente === 'fechado' ? 'üè¢ Fechado' : ambiente === 'aberto' ? 'üå≥ Aberto' : 'üîÄ Ambos';
                
                const dominantDiv = document.getElementById('dominant-family');
                const adviceDiv = document.getElementById('balance-advice');
                const nextDiv = document.getElementById('next-purchase');
                
                const infoCards = `
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin-bottom: 20px;">
                        <div style="background: linear-gradient(135deg, rgba(100, 150, 255, 0.15), rgba(100, 150, 255, 0.05)); border: 2px solid rgba(100, 150, 255, 0.4); border-radius: 8px; padding: 12px;">
                            <div style="font-size: 0.85em; color: #9bc4ff; margin-bottom: 6px; font-weight: 600;">üå°Ô∏è CLIMA</div>
                            <div style="color: #fff; font-size: 0.95em;">${climaLabel}</div>
                        </div>
                        <div style="background: linear-gradient(135deg, rgba(100, 150, 255, 0.15), rgba(100, 150, 255, 0.05)); border: 2px solid rgba(100, 150, 255, 0.4); border-radius: 8px; padding: 12px;">
                            <div style="font-size: 0.85em; color: #9bc4ff; margin-bottom: 6px; font-weight: 600;">üíº AMBIENTE</div>
                            <div style="color: #fff; font-size: 0.95em;">${ambienteLabel}</div>
                        </div>
                        <div style="background: linear-gradient(135deg, rgba(212, 175, 55, 0.15), rgba(212, 175, 55, 0.05)); border: 2px solid rgba(212, 175, 55, 0.4); border-radius: 8px; padding: 12px;">
                            <div style="font-size: 0.85em; color: #d4af37; margin-bottom: 6px; font-weight: 600;">üìä TOTAL</div>
                            <div style="color: #fff; font-size: 1.3em; font-weight: 700;">${analise.total_perfumes} perfumes</div>
                        </div>
                        <div style="background: linear-gradient(135deg, rgba(212, 175, 55, 0.15), rgba(212, 175, 55, 0.05)); border: 2px solid rgba(212, 175, 55, 0.4); border-radius: 8px; padding: 12px;">
                            <div style="font-size: 0.85em; color: #d4af37; margin-bottom: 6px; font-weight: 600;">üéØ FAM√çLIAS</div>
                            <div style="color: #fff; font-size: 1.3em; font-weight: 700;">${analise.familias_representadas}/9</div>
                        </div>
                        <div style="background: linear-gradient(135deg, rgba(212, 175, 55, 0.2), rgba(212, 175, 55, 0.1)); border: 3px solid #d4af37; border-radius: 8px; padding: 12px; grid-column: 1 / -1;">
                            <div style="font-size: 0.85em; color: #d4af37; margin-bottom: 8px; font-weight: 600;">üëë FAM√çLIA DOMINANTE</div>
                            <div style="color: #fff; font-size: 1.2em; font-weight: 700; margin-bottom: 4px;">${analise.familia_dominante.nome}</div>
                            <div style="color: #f4e5b1; font-size: 1em;">${analise.familia_dominante.quantidade} perfumes ¬∑ <strong style="color: #d4af37; font-size: 1.15em;">${analise.familia_dominante.porcentagem}%</strong> da cole√ß√£o</div>
                        </div>
                    </div>
                    
                    <div style="background: rgba(30, 30, 30, 0.5); border: 2px solid rgba(212, 175, 55, 0.3); border-radius: 12px; padding: 20px; margin-bottom: 20px;">
                        <div style="font-size: 1.1em; color: #d4af37; margin-bottom: 15px; font-weight: 700; text-align: center;">üìä DISTRIBUI√á√ÉO DAS FAM√çLIAS OLFATIVAS</div>
                        <canvas id="grafico-familias" style="max-width: 400px; max-height: 400px; margin: 0 auto; display: block;"></canvas>
                    </div>
                `;
                
                dominantDiv.innerHTML = `
                    <div style="background: rgba(212, 175, 55, 0.15); padding: 15px; border-radius: 8px; margin-bottom: 15px; border-left: 4px solid #d4af37;">
                        <div style="font-size: 1.3em; margin-bottom: 10px;">${analise.nivel.emoji} <strong>SEU N√çVEL: ${analise.nivel.titulo}</strong></div>
                        <div style="color: #ccc; font-size: 0.95em;">${analise.nivel.descricao}</div>
                    </div>
                    ${infoCards}
                `;
                
                // Renderizar gr√°fico
                setTimeout(() => renderizarGrafico(analise.perfumes_por_familia), 100);
                
                const percentage = analise.familia_dominante.porcentagem;
                let statusHtml = '';
                
                if (percentage >= 50) {
                    statusHtml = `
                        <div style="text-align: center; margin-bottom: 15px;">
                            <div style="display: inline-block; background: linear-gradient(135deg, rgba(212, 175, 55, 0.2), rgba(212, 175, 55, 0.1)); border: 2px solid #d4af37; border-radius: 8px; padding: 10px 30px;">
                                <span style="color: #d4af37; font-size: 1.3em; font-weight: 700; letter-spacing: 2px;">üìã DIAGN√ìSTICO</span>
                            </div>
                        </div>
                        <div style="background: linear-gradient(135deg, rgba(255, 50, 50, 0.3), rgba(200, 0, 0, 0.2)); border: 4px solid #ff3333; border-radius: 12px; padding: 25px; margin-bottom: 20px;">
                            <div style="font-size: 2em; text-align: center; margin-bottom: 10px;">üö®</div>
                            <div style="font-size: 1.5em; font-weight: 700; color: #ff6666; text-align: center; text-transform: uppercase;">ATEN√á√ÉO: COLE√á√ÉO DESBALANCEADA!</div>
                        </div>
                        <div style="font-size: 1.25em; line-height: 1.8; margin-top: 15px; text-align: center;">
                            <strong style="color: #ff6666; font-size: 1.4em;">VOC√ä EST√Å DESPERDI√áANDO DINHEIRO!</strong><br><br>
                            <span style="font-size: 1.15em; color: #fff;">${analise.equilibrio.mensagem}</span>
                        </div>
                    `;
                } else if (percentage >= 35) {
                    statusHtml = `
                        <div style="text-align: center; margin-bottom: 15px;">
                            <div style="display: inline-block; background: linear-gradient(135deg, rgba(212, 175, 55, 0.2), rgba(212, 175, 55, 0.1)); border: 2px solid #d4af37; border-radius: 8px; padding: 10px 30px;">
                                <span style="color: #d4af37; font-size: 1.3em; font-weight: 700; letter-spacing: 2px;">üìã DIAGN√ìSTICO</span>
                            </div>
                        </div>
                        <div style="background: linear-gradient(135deg, rgba(255, 165, 0, 0.3), rgba(255, 140, 0, 0.2)); border: 4px solid #ff9933; border-radius: 12px; padding: 25px; margin-bottom: 20px;">
                            <div style="font-size: 2em; text-align: center; margin-bottom: 10px;">‚ö†Ô∏è</div>
                            <div style="font-size: 1.4em; font-weight: 700; color: #ffaa00; text-align: center; text-transform: uppercase;">Alerta: Cole√ß√£o com Vi√©s!</div>
                        </div>
                        <div style="font-size: 1.25em; line-height: 1.8; margin-top: 15px; text-align: center;">
                            <strong style="color: #ffaa00; font-size: 1.3em;">SUA COLE√á√ÉO EST√Å DESEQUILIBRADA!</strong><br><br>
                            <span style="font-size: 1.15em; color: #fff;">${analise.equilibrio.mensagem}</span>
                        </div>
                    `;
                } else {
                    statusHtml = `
                        <div style="text-align: center; margin-bottom: 15px;">
                            <div style="display: inline-block; background: linear-gradient(135deg, rgba(212, 175, 55, 0.2), rgba(212, 175, 55, 0.1)); border: 2px solid #d4af37; border-radius: 8px; padding: 10px 30px;">
                                <span style="color: #d4af37; font-size: 1.3em; font-weight: 700; letter-spacing: 2px;">üìã DIAGN√ìSTICO</span>
                            </div>
                        </div>
                        <div style="background: linear-gradient(135deg, rgba(76, 175, 80, 0.2), rgba(76, 175, 80, 0.1)); border: 3px solid rgba(76, 175, 80, 0.5); border-radius: 12px; padding: 20px; margin-bottom: 20px; text-align: center;">
                            <div style="font-size: 1.8em; margin-bottom: 8px;">‚úÖ</div>
                            <div style="font-size: 1.3em; font-weight: 700; color: #4caf50;">COLE√á√ÉO EQUILIBRADA!</div>
                            <div style="color: #ccc; margin-top: 10px;">Boa distribui√ß√£o entre as fam√≠lias</div>
                        </div>
                    `;
                }
                
                let missingHtml = '';
                if (analise.top3_faltando && analise.top3_faltando.length > 0) {
                    missingHtml = '<div style="margin-top: 20px;"><div style="font-size: 1.1em; color: #d4af37; margin-bottom: 15px; font-weight: 700;">üîç TOP 3 FAM√çLIAS QUE FALTAM:</div>';
                    analise.top3_faltando.forEach((fam, i) => {
                        missingHtml += `<div style="background: rgba(212, 175, 55, 0.08); border-left: 4px solid #d4af37; padding: 12px; margin-bottom: 8px; border-radius: 6px;"><span style="color: #d4af37; font-weight: 700;">${i + 1}.</span> <span style="color: #fff; margin-left: 8px;">${fam}</span></div>`;
                    });
                    missingHtml += '</div>';
                }
                
                adviceDiv.innerHTML = statusHtml + missingHtml;
                
                let recomendacoesHtml = '<div style="margin-top: 30px;"><div style="font-size: 1.5em; color: #d4af37; font-weight: 700; margin-bottom: 20px; text-align: center;">üéÅ 3 RECOMENDA√á√ïES PERSONALIZADAS</div>';
                
                recomendacoes.forEach((rec, i) => {
                    recomendacoesHtml += `
                        <div style="background: linear-gradient(135deg, rgba(212, 175, 55, 0.15), rgba(212, 175, 55, 0.05)); border: 2px solid rgba(212, 175, 55, 0.3); border-radius: 12px; padding: 20px; margin-bottom: 15px;">
                            <div style="font-size: 1.3em; color: #d4af37; font-weight: 700; margin-bottom: 8px;">${i + 1}Ô∏è‚É£ ${rec.nome}</div>
                            <div style="color: #f4e5b1; font-size: 0.95em; margin-bottom: 8px;">${rec.familia} ‚Ä¢ ${rec.faixa_preco}</div>
                            <div style="color: #ccc; font-size: 0.9em; margin-bottom: 6px;"><strong style="color: #d4af37;">Por qu√™:</strong> ${rec.por_que}</div>
                            <div style="color: #ccc; font-size: 0.9em;"><strong style="color: #d4af37;">Quando usar:</strong> ${rec.quando_usar}</div>
                        </div>
                    `;
                });
                
                recomendacoesHtml += '</div>';
                nextDiv.innerHTML = recomendacoesHtml;
                
                console.log('‚úÖ Resultado renderizado!');
                
            } catch (e) {
                console.error('‚ùå Erro:', e);
                mostrarErro('Erro ao processar resposta da IA.');
            }
        }
        
        function renderizarGrafico(perfumesPorFamilia) {
            const canvas = document.getElementById('grafico-familias');
            if (!canvas) {
                console.error('‚ùå Canvas n√£o encontrado');
                return;
            }
            
            const familias = Object.keys(perfumesPorFamilia);
            const valores = Object.values(perfumesPorFamilia);
            
            new Chart(canvas, {
                type: 'radar',
                data: {
                    labels: familias,
                    datasets: [{
                        label: 'Perfumes por Fam√≠lia',
                        data: valores,
                        backgroundColor: 'rgba(212, 175, 55, 0.2)',
                        borderColor: 'rgba(212, 175, 55, 0.8)',
                        borderWidth: 2,
                        pointBackgroundColor: '#d4af37',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: '#d4af37'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                color: '#fff',
                                font: { size: 10 },
                                padding: 8,
                                boxWidth: 15,
                                boxHeight: 15
                            },
                            align: 'center',
                            maxWidth: 700
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const label = context.label || '';
                                    const value = context.parsed.r || 0;
                                    return label + ': ' + value + ' perfumes';
                                }
                            }
                        }
                    },
                    scales: {
                        r: {
                            beginAtZero: true,
                            ticks: {
                                color: '#fff',
                                backdropColor: 'transparent',
                                font: { size: 10 },
                                stepSize: 1
                            },
                            grid: {
                                color: 'rgba(212, 175, 55, 0.2)'
                            },
                            pointLabels: {
                                color: '#d4af37',
                                font: { size: 11, weight: 'bold' }
                            }
                        }
                    }
                }
            });
        }
        
        function mostrarErro(mensagem) {
            const dominantDiv = document.getElementById('dominant-family');
            dominantDiv.innerHTML = `
                <div style="background: rgba(255, 0, 0, 0.1); border: 2px solid rgba(255, 0, 0, 0.3); border-radius: 12px; padding: 30px; text-align: center;">
                    <div style="font-size: 2em; margin-bottom: 15px;">‚ùå</div>
                    <div style="color: #ff6666; font-size: 1.2em; font-weight: 700;">${mensagem}</div>
                    <div style="color: #ccc; margin-top: 15px;">Tente novamente ou entre em contato com o suporte.</div>
                </div>
            `;
        }
        function formatarNome(nome) {
            return nome
                .trim()
                .toLowerCase()
                .split(' ')
                .map(palavra => palavra.charAt(0).toUpperCase() + palavra.slice(1))
                .join(' ');
        }

        // Adicionar perfume
        function adicionarPerfume() {
            const input = document.getElementById('perfume-input');
            let nome = input.value.trim();
            
            if (!nome) {
                alert('‚ö†Ô∏è Digite o nome do perfume!');
                return;
            }
            
            // Formatar nome (Title Case)
            nome = formatarNome(nome);
            
            // Pegar cole√ß√£o atual
            let colecao = JSON.parse(localStorage.getItem('minhaColecao') || '[]');
            
            // Verificar duplicata
            if (colecao.includes(nome)) {
                alert('‚ö†Ô∏è Este perfume j√° est√° na sua cole√ß√£o!');
                return;
            }
            
            // Adicionar √† cole√ß√£o
            colecao.push(nome);
            localStorage.setItem('minhaColecao', JSON.stringify(colecao));
            
            // Limpar input
            input.value = '';
            
            // Atualizar contador
            atualizarContador();
            
            // Feedback visual
            input.style.borderColor = '#00ff00';
            setTimeout(() => {
                input.style.borderColor = 'rgba(212, 175, 55, 0.3)';
            }, 500);
            
            console.log('‚úÖ Perfume adicionado:', nome);
        }

        // Atualizar contador
        function atualizarContador() {
            const colecao = JSON.parse(localStorage.getItem('minhaColecao') || '[]');
            const count = colecao.length;
            const countEl = document.getElementById('perfume-count');
            if (countEl) {
                countEl.textContent = count;
            }
            
            // Habilitar/desabilitar bot√£o ver cole√ß√£o
            const btn = document.getElementById('btn-ver-colecao');
            if (btn) {
                if (count === 0) {
                    btn.style.opacity = '0.5';
                    btn.style.cursor = 'not-allowed';
                    btn.disabled = true;
                } else {
                    btn.style.opacity = '1';
                    btn.style.cursor = 'pointer';
                    btn.disabled = false;
                }
            }
        }

        // Abrir popup da cole√ß√£o
        function abrirPopupColecao() {
            const colecao = JSON.parse(localStorage.getItem('minhaColecao') || '[]');
            
            if (colecao.length === 0) {
                alert('‚ö†Ô∏è Sua cole√ß√£o est√° vazia!');
                return;
            }
            
            // Criar overlay
            const overlay = document.createElement('div');
            overlay.id = 'popup-colecao';
            overlay.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.9);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 10000;
                animation: fadeIn 0.3s ease;
            `;
            
            // Criar conte√∫do do popup
            overlay.innerHTML = `
                <div style="
                    background: linear-gradient(135deg, #2d2d2d 0%, #1e1e1e 100%);
                    border: 3px solid #d4af37;
                    border-radius: 20px;
                    padding: 30px;
                    max-width: 600px;
                    width: 90%;
                    max-height: 80vh;
                    overflow-y: auto;
                    box-shadow: 0 20px 60px rgba(212, 175, 55, 0.5);
                ">
                    <div style="
                        display: flex;
                        justify-content: space-between;
                        align-items: center;
                        margin-bottom: 25px;
                        padding-bottom: 20px;
                        border-bottom: 2px solid rgba(212, 175, 55, 0.3);
                    ">
                        <h2 style="color: #d4af37; margin: 0; font-size: 1.8em;">
                            üìö Minha Cole√ß√£o (${colecao.length})
                        </h2>
                        <button 
                            onclick="fecharPopupColecao()"
                            style="
                                background: rgba(255, 0, 0, 0.2);
                                border: 2px solid rgba(255, 0, 0, 0.4);
                                border-radius: 8px;
                                color: #ff6666;
                                padding: 8px 15px;
                                cursor: pointer;
                                font-weight: 600;
                            "
                        >
                            ‚úï Fechar
                        </button>
                    </div>
                    
                    <div id="lista-perfumes" style="display: flex; flex-direction: column; gap: 12px;">
                        ${colecao.map((perfume, index) => `
                            <div style="
                                display: flex;
                                justify-content: space-between;
                                align-items: center;
                                padding: 15px;
                                background: rgba(212, 175, 55, 0.08);
                                border: 2px solid rgba(212, 175, 55, 0.2);
                                border-radius: 12px;
                                transition: all 0.3s ease;
                            "
                            onmouseover="this.style.borderColor='rgba(212, 175, 55, 0.5)'; this.style.background='rgba(212, 175, 55, 0.12)'"
                            onmouseout="this.style.borderColor='rgba(212, 175, 55, 0.2)'; this.style.background='rgba(212, 175, 55, 0.08)'"
                            >
                                <div style="
                                    display: flex;
                                    align-items: center;
                                    gap: 15px;
                                    flex: 1;
                                ">
                                    <span style="
                                        color: #d4af37;
                                        font-weight: 700;
                                        font-size: 1.2em;
                                        min-width: 30px;
                                    ">${index + 1}.</span>
                                    <span style="color: #fff; font-size: 1em;">${perfume}</span>
                                </div>
                                <button 
                                    onclick="removerPerfume(${index})"
                                    style="
                                        background: rgba(255, 0, 0, 0.15);
                                        border: 2px solid rgba(255, 0, 0, 0.3);
                                        border-radius: 8px;
                                        color: #ff6666;
                                        padding: 8px 12px;
                                        cursor: pointer;
                                        font-size: 0.9em;
                                        transition: all 0.3s ease;
                                    "
                                    onmouseover="this.style.background='rgba(255, 0, 0, 0.3)'; this.style.borderColor='#ff0000'"
                                    onmouseout="this.style.background='rgba(255, 0, 0, 0.15)'; this.style.borderColor='rgba(255, 0, 0, 0.3)'"
                                >
                                    üóëÔ∏è Excluir
                                </button>
                            </div>
                        `).join('')}
                    </div>
                    
                    <div style="
                        margin-top: 25px;
                        padding-top: 20px;
                        border-top: 2px solid rgba(212, 175, 55, 0.3);
                        text-align: center;
                    ">
                        <button 
                            onclick="limparColecao()"
                            style="
                                background: rgba(255, 0, 0, 0.2);
                                border: 2px solid rgba(255, 0, 0, 0.4);
                                border-radius: 10px;
                                color: #ff6666;
                                padding: 12px 25px;
                                cursor: pointer;
                                font-weight: 600;
                                transition: all 0.3s ease;
                            "
                            onmouseover="this.style.background='rgba(255, 0, 0, 0.3)'"
                            onmouseout="this.style.background='rgba(255, 0, 0, 0.2)'"
                        >
                            üóëÔ∏è LIMPAR TODA A COLE√á√ÉO
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(overlay);
        }

        // Fechar popup
        function fecharPopupColecao() {
            const popup = document.getElementById('popup-colecao');
            if (popup) {
                popup.style.animation = 'fadeOut 0.3s ease';
                setTimeout(() => popup.remove(), 300);
            }
        }

        // Remover perfume
        function removerPerfume(index) {
            if (!confirm('Tem certeza que deseja remover este perfume?')) {
                return;
            }
            
            let colecao = JSON.parse(localStorage.getItem('minhaColecao') || '[]');
            const perfumeRemovido = colecao[index];
            
            colecao.splice(index, 1);
            localStorage.setItem('minhaColecao', JSON.stringify(colecao));
            
            console.log('üóëÔ∏è Perfume removido:', perfumeRemovido);
            
            // Atualizar contador
            atualizarContador();
            
            // Fechar e reabrir popup (para atualizar lista)
            fecharPopupColecao();
            
            if (colecao.length > 0) {
                setTimeout(() => abrirPopupColecao(), 350);
            }
        }

        // Limpar toda a cole√ß√£o
        function limparColecao() {
            if (!confirm('‚ö†Ô∏è ATEN√á√ÉO: Isso ir√° remover TODOS os perfumes da sua cole√ß√£o!\n\nTem certeza?')) {
                return;
            }
            
            localStorage.removeItem('minhaColecao');
            console.log('üóëÔ∏è Cole√ß√£o limpa!');
            
            atualizarContador();
            fecharPopupColecao();
        }

        // Inicializar ao carregar p√°gina
        (function() {
            // Event listener para Enter no input
            const input = document.getElementById('perfume-input');
            if (input) {

                input.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        adicionarPerfume();
                    }
                });
            }
            
            atualizarContador();
        })();

        // ===============================================
        // PERGUNTAR AO PERFUMISTA
        // ===============================================
        async function perguntarAoPerfumista() {
            const perguntaInput = document.getElementById('pergunta-input');
            const pergunta = perguntaInput.value.trim();
            
            if (!pergunta) {
                alert('Por favor, digite sua pergunta!');
                return;
            }
            
            console.log('üí¨ Pergunta:', pergunta);
            
            // Pegar cole√ß√£o atual
            const colecao = JSON.parse(localStorage.getItem('perfumes') || '[]');
            
            // Pegar contexto
            const clima = localStorage.getItem('clima') || 'temperado';
            const ambiente = localStorage.getItem('ambiente') || 'fechado';
            const orcamento = localStorage.getItem('orcamento') || 'R$ 350 - R$ 1.500';
            
            // Mostrar loading
            const respostaDiv = document.getElementById('resposta-pergunta');
            const textoResposta = document.getElementById('texto-resposta');
            const sugestoes = document.getElementById('sugestoes-lista');
            
            respostaDiv.style.display = 'block';
            textoResposta.innerHTML = '‚è≥ Consultando O Perfumista...';
            sugestoes.innerHTML = '';
            
            try {
                const response = await fetch('https://operfumista-api.vercel.app/api/perfumista', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        pergunta: pergunta,
                        colecao: colecao,
                        clima: clima,
                        ambiente: ambiente,
                        orcamento: orcamento
                    })
                });
                
                if (!response.ok) {
                    throw new Error('Erro na API');
                }
                
                const data = await response.json();
                console.log('‚úÖ Resposta:', data);
                
                // Mostrar resposta
                textoResposta.innerHTML = data.resposta || 'Aqui est√£o suas sugest√µes personalizadas:';
                
                // Mostrar sugest√µes
                sugestoes.innerHTML = data.sugestoes.map((sug, index) => `
                    <div style="
                        background: rgba(0, 0, 0, 0.3);
                        border: 2px solid rgba(212, 175, 55, 0.3);
                        border-radius: 12px;
                        padding: 20px;
                    ">
                        <div style="
                            color: #d4af37;
                            font-weight: 700;
                            font-size: 1.2em;
                            margin-bottom: 10px;
                        ">
                            ${index + 1}. ${sug.nome}
                        </div>
                        
                        <div style="
                            display: flex;
                            gap: 15px;
                            margin-bottom: 12px;
                            flex-wrap: wrap;
                        ">
                            <span style="
                                background: rgba(212, 175, 55, 0.2);
                                padding: 5px 12px;
                                border-radius: 6px;
                                color: #f4e5b1;
                                font-size: 0.9em;
                            ">
                                ${sug.familia}
                            </span>
                            <span style="
                                background: rgba(100, 200, 100, 0.2);
                                padding: 5px 12px;
                                border-radius: 6px;
                                color: #90EE90;
                                font-size: 0.9em;
                                font-weight: 600;
                            ">
                                ${sug.faixa_preco}
                            </span>
                        </div>
                        
                        <div style="color: #ccc; margin-bottom: 8px; line-height: 1.5;">
                            <strong style="color: #d4af37;">Por qu√™:</strong> ${sug.por_que}
                        </div>
                        
                        <div style="color: #ccc; line-height: 1.5;">
                            <strong style="color: #d4af37;">Quando usar:</strong> ${sug.quando_usar}
                        </div>
                    </div>
                `).join('');
                
                // Scroll suave at√© a resposta
                respostaDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                
            } catch (error) {
                console.error('‚ùå Erro:', error);
                textoResposta.innerHTML = '‚ùå Erro ao consultar O Perfumista. Tente novamente.';
                sugestoes.innerHTML = '';
            }
        }

    </script>
    
    <!-- Chart.js para gr√°ficos -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</body>
</html>
